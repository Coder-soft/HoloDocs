<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Security & API Scopes - HoloBridge</title>
    <meta name="description" content="Learn about HoloBridge API scopes, rate limiting, and security features.">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <header>
        <div class="container header-content">
            <a href="index.html" class="logo">HoloBridge</a>
            <nav>
                <a href="index.html">Home</a>
                <a href="getting-started.html">Getting Started</a>
                <a href="api-reference.html">API Reference</a>
                <a href="websocket.html">WebSocket</a>
                <a href="plugins.html">Plugins</a>
                <a href="security.html" class="active">Security</a>
                <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
            </nav>
        </div>
    </header>

    <main>
        <div class="container">
            <h1>Security & API Scopes</h1>
            <p>HoloBridge provides granular access control through API scopes, allowing you to create API keys with
                limited permissions.</p>

            <h2>API Key Configuration</h2>

            <h3>Single Key (Simple)</h3>
            <p>For basic setups, use a single API key in <code>.env</code>:</p>
            <pre><code>API_KEY=your_secure_api_key</code></pre>
            <p>This key has <code>admin</code> scope (full access).</p>

            <h3>Multiple Keys with Scopes</h3>
            <p>For production, define multiple keys with specific permissions using the <code>API_KEYS</code>
                environment variable:</p>
            <pre><code>API_KEYS=[
  {"id":"dashboard","name":"Web Dashboard","key":"dash_xxx","scopes":["read:guilds","read:members"]},
  {"id":"bot","name":"Chat Bot","key":"bot_xxx","scopes":["read:messages","write:messages"]},
  {"id":"admin","name":"Admin Panel","key":"admin_xxx","scopes":["admin"]}
]</code></pre>

            <h2>Available Scopes</h2>
            <table>
                <thead>
                    <tr>
                        <th>Scope</th>
                        <th>Permissions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>read:guilds</code></td>
                        <td>List guilds, get guild details</td>
                    </tr>
                    <tr>
                        <td><code>read:channels</code></td>
                        <td>List channels, get channel info</td>
                    </tr>
                    <tr>
                        <td><code>read:members</code></td>
                        <td>List members, get member details</td>
                    </tr>
                    <tr>
                        <td><code>read:messages</code></td>
                        <td>Read message history</td>
                    </tr>
                    <tr>
                        <td><code>write:messages</code></td>
                        <td>Send, edit, delete messages</td>
                    </tr>
                    <tr>
                        <td><code>write:members</code></td>
                        <td>Kick, ban, timeout members</td>
                    </tr>
                    <tr>
                        <td><code>write:channels</code></td>
                        <td>Create, edit, delete channels</td>
                    </tr>
                    <tr>
                        <td><code>write:roles</code></td>
                        <td>Create, edit, delete roles</td>
                    </tr>
                    <tr>
                        <td><code>events</code></td>
                        <td>Subscribe to WebSocket events</td>
                    </tr>
                    <tr>
                        <td><code>admin</code></td>
                        <td>Full access (bypasses all checks)</td>
                    </tr>
                </tbody>
            </table>

            <h2>Rate Limiting</h2>
            <p>HoloBridge includes built-in rate limiting to protect against abuse.</p>

            <h3>Configuration</h3>
            <pre><code>RATE_LIMIT_ENABLED=true
RATE_LIMIT_WINDOW_MS=60000  # 1 minute window
RATE_LIMIT_MAX=100          # 100 requests per window</code></pre>

            <h3>Response Headers</h3>
            <p>All API responses include rate limit headers:</p>
            <table>
                <thead>
                    <tr>
                        <th>Header</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>X-RateLimit-Limit</code></td>
                        <td>Maximum requests per window</td>
                    </tr>
                    <tr>
                        <td><code>X-RateLimit-Remaining</code></td>
                        <td>Requests remaining in current window</td>
                    </tr>
                    <tr>
                        <td><code>X-RateLimit-Reset</code></td>
                        <td>Unix timestamp when limit resets</td>
                    </tr>
                </tbody>
            </table>

            <h3>Rate Limited Response</h3>
            <p>When the limit is exceeded, you'll receive:</p>
            <pre><code>{
  "success": false,
  "error": "Too many requests",
  "code": "RATE_LIMITED",
  "retryAfter": 45
}</code></pre>

            <div class="alert alert-warning">
                <strong>‚ö†Ô∏è Best Practices:</strong>
                <ul>
                    <li>Use scoped keys ‚Äî give each integration only the permissions it needs</li>
                    <li>Rotate keys regularly ‚Äî update API keys periodically</li>
                    <li>Keep admin keys secure ‚Äî only use admin scope for trusted applications</li>
                    <li>Monitor usage ‚Äî watch rate limit headers to identify issues</li>
                </ul>
            </div>

            <h2>Next Steps</h2>
            <div class="cards">
                <a href="api-reference.html" class="card">
                    <h4>üìñ API Reference</h4>
                    <p>Explore all available REST API endpoints.</p>
                </a>
                <a href="getting-started.html" class="card">
                    <h4>üöÄ Getting Started</h4>
                    <p>Set up HoloBridge for the first time.</p>
                </a>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>HoloBridge &copy; 2025 - MIT License</p>
        </div>
    </footer>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            if (current === 'dark') {
                html.setAttribute('data-theme', 'light');
                localStorage.setItem('theme', 'light');
            } else if (current === 'light') {
                html.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
            } else {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                const newTheme = prefersDark ? 'light' : 'dark';
                html.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
            }
        }

        (function () {
            const saved = localStorage.getItem('theme');
            if (saved) {
                document.documentElement.setAttribute('data-theme', saved);
            }
        })();
    </script>
</body>

</html>