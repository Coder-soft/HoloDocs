<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebSocket Events - Holo Bridge</title>
    <meta name="description" content="Real-time Discord event streaming documentation for Holo Bridge.">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <header>
        <div class="container header-content">
            <a href="index.html" class="logo">Holo Bridge</a>
            <nav>
                <a href="index.html">Home</a>
                <a href="getting-started.html">Getting Started</a>
                <a href="api-reference.html">API Reference</a>
                <a href="websocket.html" class="active">WebSocket</a>
                <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
            </nav>
        </div>
    </header>

    <main>
        <div class="container docs-layout">
            <aside class="sidebar">
                <h4>Getting Started</h4>
                <ul>
                    <li><a href="#connection">Connection</a></li>
                    <li><a href="#authentication">Authentication</a></li>
                    <li><a href="#subscribing">Subscribing</a></li>
                </ul>
                <h4>Events</h4>
                <ul>
                    <li><a href="#message-events">Message Events</a></li>
                    <li><a href="#member-events">Member Events</a></li>
                    <li><a href="#channel-events">Channel Events</a></li>
                    <li><a href="#thread-events">Thread Events</a></li>
                    <li><a href="#role-events">Role Events</a></li>
                    <li><a href="#guild-events">Guild Events</a></li>
                    <li><a href="#voice-events">Voice Events</a></li>
                    <li><a href="#other-events">Other Events</a></li>
                </ul>
            </aside>

            <div class="content">
                <h1>WebSocket Events</h1>
                <p>Holo Bridge provides real-time event streaming via Socket.IO. Subscribe to guilds and receive
                    Discord events as they happen.</p>

                <section id="connection">
                    <h2>Connection</h2>
                    <p>Connect to the WebSocket server using Socket.IO:</p>
                    <pre><code>import { io } from 'socket.io-client';

const socket = io('http://localhost:3000', {
    auth: {
        apiKey: 'your_api_key'
    }
});

socket.on('connect', () => {
    console.log('Connected to Holo Bridge');
});

socket.on('connect_error', (error) => {
    console.error('Connection error:', error.message);
});

socket.on('disconnect', (reason) => {
    console.log('Disconnected:', reason);
});</code></pre>
                </section>

                <section id="authentication">
                    <h2>Authentication</h2>
                    <p>Authentication is required and must be provided in the <code>auth</code> option when connecting:
                    </p>
                    <pre><code>const socket = io('http://localhost:3000', {
    auth: {
        apiKey: 'your_secure_api_key'
    }
});</code></pre>
                    <div class="alert alert-info">
                        <strong>Note:</strong> If authentication fails, the connection will be rejected with an error.
                    </div>
                </section>

                <section id="subscribing">
                    <h2>Subscribing to Guilds</h2>
                    <p>After connecting, subscribe to specific guilds to receive their events:</p>
                    <pre><code>// Subscribe to guilds
socket.emit('subscribe', {
    guildIds: ['123456789012345678', '987654321098765432']
});

// Listen for subscription confirmation
socket.on('subscribed', (data) => {
    console.log('Subscribed to guilds:', data.guildIds);
});

// Unsubscribe from guilds
socket.emit('unsubscribe', {
    guildIds: ['123456789012345678']
});

socket.on('unsubscribed', (data) => {
    console.log('Unsubscribed from guilds:', data.guildIds);
});</code></pre>

                    <h3>Listening for Events</h3>
                    <p>All Discord events are emitted through the <code>discord</code> event:</p>
                    <pre><code>socket.on('discord', (payload) => {
    console.log('Event:', payload.event);
    console.log('Guild:', payload.guildId);
    console.log('Data:', payload.data);
    
    // Handle specific events
    switch (payload.event) {
        case 'messageCreate':
            handleNewMessage(payload.data);
            break;
        case 'guildMemberAdd':
            handleMemberJoin(payload.data);
            break;
        // ... handle other events
    }
});</code></pre>
                </section>

                <section id="message-events">
                    <h2>Message Events</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Description</th>
                                <th>Data</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>messageCreate</code></td>
                                <td>New message sent</td>
                                <td>SerializedMessage</td>
                            </tr>
                            <tr>
                                <td><code>messageUpdate</code></td>
                                <td>Message edited</td>
                                <td><code>{ old, new }</code></td>
                            </tr>
                            <tr>
                                <td><code>messageDelete</code></td>
                                <td>Message deleted</td>
                                <td><code>{ id, channelId, guildId }</code></td>
                            </tr>
                            <tr>
                                <td><code>messageDeleteBulk</code></td>
                                <td>Multiple messages deleted</td>
                                <td><code>{ ids, channelId, guildId }</code></td>
                            </tr>
                            <tr>
                                <td><code>messageReactionAdd</code></td>
                                <td>Reaction added</td>
                                <td><code>{ messageId, channelId, guildId, userId, reaction }</code></td>
                            </tr>
                            <tr>
                                <td><code>messageReactionRemove</code></td>
                                <td>Reaction removed</td>
                                <td><code>{ messageId, channelId, guildId, userId, emoji }</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Message Object</h3>
                    <pre><code>{
    "id": "123456789",
    "channelId": "987654321",
    "guildId": "111222333",
    "author": {
        "id": "444555666",
        "username": "user",
        "discriminator": "0",
        "globalName": "Display Name",
        "avatar": "abc123",
        "avatarUrl": "https://cdn.discordapp.com/...",
        "bot": false,
        "system": false,
        "createdAt": "2020-01-01T00:00:00.000Z"
    },
    "member": {
        "id": "444555666",
        "displayName": "Display Name",
        "nickname": "Nick",
        "avatar": null,
        "displayAvatarUrl": "https://cdn.discordapp.com/...",
        "joinedAt": "2025-01-01T00:00:00.000Z",
        "premiumSince": null,
        "roles": ["111222333"],
        "pending": false,
        "communicationDisabledUntil": null,
        "permissions": ["SendMessages", "ViewChannel"]
    },
    "content": "Hello, world!",
    "cleanContent": "Hello, world!",
    "createdAt": "2025-01-01T12:00:00.000Z",
    "editedAt": null,
    "embeds": [],
    "attachments": [],
    "reactions": [],
    "pinned": false,
    "tts": false,
    "type": 0,
    "typeName": "0",
    "replyTo": null,
    "mentions": {
        "users": [],
        "roles": [],
        "channels": [],
        "everyone": false
    }
}</code></pre>
                </section>

                <section id="member-events">
                    <h2>Member Events</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Description</th>
                                <th>Data</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>guildMemberAdd</code></td>
                                <td>Member joined</td>
                                <td>SerializedMember</td>
                            </tr>
                            <tr>
                                <td><code>guildMemberRemove</code></td>
                                <td>Member left/kicked</td>
                                <td><code>{ user, guildId }</code></td>
                            </tr>
                            <tr>
                                <td><code>guildMemberUpdate</code></td>
                                <td>Member updated</td>
                                <td><code>{ old, new }</code></td>
                            </tr>
                            <tr>
                                <td><code>presenceUpdate</code></td>
                                <td>Presence changed</td>
                                <td><code>{ old, new }</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Member Object</h3>
                    <pre><code>{
    "id": "444555666",
    "displayName": "Display Name",
    "nickname": "Nickname",
    "avatar": null,
    "displayAvatarUrl": "https://cdn.discordapp.com/...",
    "joinedAt": "2025-01-01T00:00:00.000Z",
    "premiumSince": null,
    "roles": ["111222333", "444555666"],
    "pending": false,
    "communicationDisabledUntil": null,
    "user": { ... },
    "permissions": ["SendMessages", "ViewChannel"]
}</code></pre>
                </section>

                <section id="channel-events">
                    <h2>Channel Events</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Description</th>
                                <th>Data</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>channelCreate</code></td>
                                <td>Channel created</td>
                                <td>SerializedChannel</td>
                            </tr>
                            <tr>
                                <td><code>channelUpdate</code></td>
                                <td>Channel modified</td>
                                <td><code>{ old, new }</code></td>
                            </tr>
                            <tr>
                                <td><code>channelDelete</code></td>
                                <td>Channel deleted</td>
                                <td>SerializedChannel</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Channel Object</h3>
                    <pre><code>{
    "id": "987654321",
    "name": "general",
    "type": 0,
    "typeName": "text",
    "parentId": "123456789",
    "createdAt": "2025-01-01T00:00:00.000Z",
    "position": 0,
    "topic": "Welcome to general chat!",
    "nsfw": false,
    "rateLimitPerUser": 0
}</code></pre>
                </section>

                <section id="thread-events">
                    <h2>Thread Events</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Description</th>
                                <th>Data</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>threadCreate</code></td>
                                <td>Thread created</td>
                                <td><code>{ thread, newlyCreated }</code></td>
                            </tr>
                            <tr>
                                <td><code>threadUpdate</code></td>
                                <td>Thread modified</td>
                                <td><code>{ old, new }</code></td>
                            </tr>
                            <tr>
                                <td><code>threadDelete</code></td>
                                <td>Thread deleted</td>
                                <td><code>{ id, guildId, parentId, name, type }</code></td>
                            </tr>
                            <tr>
                                <td><code>threadMembersUpdate</code></td>
                                <td>Thread members changed</td>
                                <td><code>{ threadId, guildId, addedMembers, removedMemberIds, memberCount }</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Thread Create Example</h3>
                    <pre><code>{
    "thread": {
        "id": "123456789",
        "name": "Discussion Thread",
        "type": 11,
        "typeName": "public_thread",
        "parentId": "987654321",
        "createdAt": "2025-01-01T12:00:00.000Z"
    },
    "newlyCreated": true
}</code></pre>

                    <h3>Thread Delete Example</h3>
                    <pre><code>{
    "id": "123456789",
    "guildId": "111222333",
    "parentId": "987654321",
    "name": "Old Thread",
    "type": 11
}</code></pre>

                    <h3>Thread Members Update Example</h3>
                    <pre><code>{
    "threadId": "123456789",
    "guildId": "111222333",
    "addedMembers": [
        {
            "id": "444555666",
            "threadId": "123456789",
            "joinedAt": "2025-01-01T12:00:00.000Z"
        }
    ],
    "removedMemberIds": ["777888999"],
    "memberCount": 5
}</code></pre>
                </section>

                <section id="role-events">
                    <h2>Role Events</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Description</th>
                                <th>Data</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>roleCreate</code></td>
                                <td>Role created</td>
                                <td>SerializedRole</td>
                            </tr>
                            <tr>
                                <td><code>roleUpdate</code></td>
                                <td>Role modified</td>
                                <td><code>{ old, new }</code></td>
                            </tr>
                            <tr>
                                <td><code>roleDelete</code></td>
                                <td>Role deleted</td>
                                <td><code>{ id, guildId }</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Role Object</h3>
                    <pre><code>{
    "id": "111222333",
    "name": "Moderator",
    "color": 3447003,
    "hexColor": "#3498db",
    "hoist": true,
    "position": 5,
    "permissions": "8589934591",
    "managed": false,
    "mentionable": true,
    "icon": null,
    "unicodeEmoji": null,
    "createdAt": "2025-01-01T00:00:00.000Z",
    "memberCount": 10
}</code></pre>
                </section>

                <section id="guild-events">
                    <h2>Guild Events</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Description</th>
                                <th>Data</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>guildCreate</code></td>
                                <td>Bot joined guild</td>
                                <td>SerializedGuild</td>
                            </tr>
                            <tr>
                                <td><code>guildUpdate</code></td>
                                <td>Guild modified</td>
                                <td><code>{ old, new }</code></td>
                            </tr>
                            <tr>
                                <td><code>guildDelete</code></td>
                                <td>Bot left/removed</td>
                                <td><code>{ id, name, unavailable }</code></td>
                            </tr>
                            <tr>
                                <td><code>guildBanAdd</code></td>
                                <td>User banned</td>
                                <td><code>{ guildId, user }</code></td>
                            </tr>
                            <tr>
                                <td><code>guildBanRemove</code></td>
                                <td>User unbanned</td>
                                <td><code>{ guildId, user }</code></td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <section id="voice-events">
                    <h2>Voice Events</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Description</th>
                                <th>Data</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>voiceStateUpdate</code></td>
                                <td>Voice state changed</td>
                                <td><code>{ old, new }</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <h3>Voice State Object</h3>
                    <pre><code>{
    "guildId": "111222333",
    "channelId": "444555666",
    "userId": "777888999",
    "member": { ... },
    "sessionId": "abc123",
    "deaf": false,
    "mute": false,
    "selfDeaf": false,
    "selfMute": true,
    "selfVideo": false,
    "streaming": false,
    "suppress": false,
    "requestToSpeakTimestamp": null
}</code></pre>
                </section>

                <section id="other-events">
                    <h2>Other Events</h2>
                    <table>
                        <thead>
                            <tr>
                                <th>Event</th>
                                <th>Description</th>
                                <th>Data</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>typingStart</code></td>
                                <td>User started typing</td>
                                <td><code>{ channelId, userId, timestamp, member }</code></td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <h2>Error Handling</h2>
                <pre><code>socket.on('error', (error) => {
    console.error('WebSocket error:', error.message);
    if (error.code) {
        console.error('Error code:', error.code);
    }
});</code></pre>

                <h2>Complete Example</h2>
                <pre><code>import { io } from 'socket.io-client';

const socket = io('http://localhost:3000', {
    auth: { apiKey: 'your_api_key' }
});

socket.on('connect', () => {
    console.log('Connected!');
    socket.emit('subscribe', { guildIds: ['123456789'] });
});

socket.on('subscribed', ({ guildIds }) => {
    console.log('Subscribed to:', guildIds);
});

socket.on('discord', (payload) => {
    switch (payload.event) {
        case 'messageCreate':
            console.log(`[${payload.data.author.username}]: ${payload.data.content}`);
            break;
        case 'messageUpdate':
            console.log(`Message edited in ${payload.data.new.channelId}`);
            break;
        case 'messageDelete':
            console.log(`Message ${payload.data.id} deleted`);
            break;
        case 'messageDeleteBulk':
            console.log(`${payload.data.ids.length} messages deleted`);
            break;
        case 'guildMemberAdd':
            console.log(`${payload.data.user.username} joined!`);
            break;
        case 'guildMemberRemove':
            console.log(`${payload.data.user.username} left!`);
            break;
        case 'threadCreate':
            console.log(`Thread ${payload.data.thread.name} created`);
            break;
        case 'threadDelete':
            console.log(`Thread ${payload.data.name} deleted`);
            break;
        case 'threadMembersUpdate':
            console.log(`Thread ${payload.data.threadId} members updated`);
            break;
        case 'channelCreate':
            console.log(`Channel ${payload.data.name} created`);
            break;
        case 'roleCreate':
            console.log(`Role ${payload.data.name} created`);
            break;
        case 'voiceStateUpdate':
            console.log(`Voice state updated for ${payload.data.new.userId}`);
            break;
        case 'typingStart':
            console.log(`User ${payload.data.userId} is typing`);
            break;
    }
});

socket.on('error', console.error);
socket.on('disconnect', (reason) => console.log('Disconnected:', reason));</code></pre>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>Holo Bridge &copy; 2025 - MIT License</p>
        </div>
    </footer>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            if (current === 'dark') {
                html.setAttribute('data-theme', 'light');
                localStorage.setItem('theme', 'light');
            } else if (current === 'light') {
                html.setAttribute('data-theme', 'dark');
                localStorage.setItem('theme', 'dark');
            } else {
                const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                const newTheme = prefersDark ? 'light' : 'dark';
                html.setAttribute('data-theme', newTheme);
                localStorage.setItem('theme', newTheme);
            }
        }

        (function () {
            const saved = localStorage.getItem('theme');
            if (saved) {
                document.documentElement.setAttribute('data-theme', saved);
            }
        })();
    </script>
</body>

</html>